// Generated by CoffeeScript 2.5.1
// Denna fil kan kastas
var Button, Transformer, button, col, draw, grid, mouseClicked, mouseMoved, setup, tx;

Transformer = class Transformer {
  constructor(x2 = 0, y2 = 0, a1 = 0, s = 1, stack = []) {
    this.x = x2;
    this.y = y2;
    this.a = a1;
    this.s = s;
    this.stack = stack;
    this.commands = [];
  }

  push() {
    push();
    return this.stack.push([this.x, this.y, this.a, this.s]);
  }

  pop() {
    pop();
    return [this.x, this.y, this.a, this.s] = this.stack.pop();
  }

  rotate(da) {
    this.commands.push(`r ${da}`);
    rotate(da);
    return this.a += da;
  }

  scale(ds) {
    this.commands.push(`s ${ds}`);
    scale(ds);
    return this.s *= ds;
  }

  translate(dx, dy) {
    this.commands.push(`t ${dx} ${dy}`);
    translate(dx, dy);
    this.x += this.s * dx * cos(this.a) - this.s * dy * sin(this.a);
    return this.y += this.s * dy * cos(this.a) + this.s * dx * sin(this.a);
  }

  getCommands() {
    return _.clone(this.commands);
  }

  backwards(x, y, commands) {
    var a, arr, command, dx, dy, k, len, ref, x1, y1;
    ref = commands.reverse();
    for (k = 0, len = ref.length; k < len; k++) {
      command = ref[k];
      arr = command.split(' ');
      if (arr[0] === 'r') {
        a = -arr[1];
        x1 = x * cos(a) - y * sin(a);
        y1 = y * cos(a) + x * sin(a);
        [x, y] = [x1, y1];
      }
      if (command[0] === 's') {
        x = x / arr[1];
        y = y / arr[1];
      }
      if (command[0] === 't') {
        dx = arr[1];
        dy = arr[2];
        x -= dx;
        y -= dy;
      }
    }
    return [x, y];
  }

  dump() {
    return console.log(this.x, this.y, this.a, this.s);
  }

};

button = tx = new Transformer();

col = 'black';

Button = class Button {
  constructor(x2, y2, w, h) {
    this.x = x2;
    this.y = y2;
    this.w = w;
    this.h = h;
  }

  draw() {
    fill(col);
    return rect(this.x, this.y, this.w, this.h);
  }

  inside(x, y) {
    return (this.x - this.w / 2 <= x && x <= this.x + this.w / 2) && (this.y - this.h / 2 <= y && y <= this.y + this.h / 2);
  }

};

setup = function() {
  createCanvas(400, 300);
  rectMode(CENTER);
  angleMode(DEGREES);
  button = new Button(0, 0, 20, 40);
  console.log('ok');
  return tx.dump();
};

grid = function() {
  var i, j, k, l, len, len1, ref, ref1, results;
  ref = range(0, width, 10);
  for (k = 0, len = ref.length; k < len; k++) {
    i = ref[k];
    line(i, 0, i, height);
  }
  ref1 = range(0, height, 10);
  results = [];
  for (l = 0, len1 = ref1.length; l < len1; l++) {
    j = ref1[l];
    results.push(line(0, j, width, j));
  }
  return results;
};

draw = function() {
  tx = new Transformer();
  tx.push();
  background('gray');
  grid();
  tx.translate(100, 50);
  tx.translate(20, 20);
  tx.rotate(90);
  //tx.scale 2
  button.commands = tx.getCommands();
  button.draw();
  return tx.pop();
};

mouseMoved = function() {
  var x, y;
  [x, y] = tx.backwards(mouseX, mouseY, button.commands);
  return col = button.inside(x, y) ? 'red' : 'white';
};

mouseClicked = function() {
  return console.log(button.commands, tx.backwards(mouseX, mouseY, button.commands));
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tldGNoLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXHNrZXRjaC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFzQjtBQUFBLElBQUEsTUFBQSxFQUFBLFdBQUEsRUFBQSxNQUFBLEVBQUEsR0FBQSxFQUFBLElBQUEsRUFBQSxJQUFBLEVBQUEsWUFBQSxFQUFBLFVBQUEsRUFBQSxLQUFBLEVBQUE7O0FBQ2hCLGNBQU4sTUFBQSxZQUFBO0VBQ0MsV0FBYSxNQUFJLENBQUosT0FBVSxDQUFWLE9BQWdCLENBQWhCLE1BQXNCLENBQXRCLFVBQWdDLEVBQWhDLENBQUE7SUFBQyxJQUFDLENBQUE7SUFBSyxJQUFDLENBQUE7SUFBSyxJQUFDLENBQUE7SUFBSyxJQUFDLENBQUE7SUFBSyxJQUFDLENBQUE7SUFDdEMsSUFBQyxDQUFBLFFBQUQsR0FBWTtFQURBOztFQUViLElBQU8sQ0FBQSxDQUFBO0lBQ04sSUFBQSxDQUFBO1dBQ0EsSUFBQyxDQUFBLEtBQUssQ0FBQyxJQUFQLENBQVksQ0FBQyxJQUFDLENBQUEsQ0FBRixFQUFJLElBQUMsQ0FBQSxDQUFMLEVBQU8sSUFBQyxDQUFBLENBQVIsRUFBVSxJQUFDLENBQUEsQ0FBWCxDQUFaO0VBRk07O0VBR1AsR0FBTSxDQUFBLENBQUE7SUFDTCxHQUFBLENBQUE7V0FDQSxDQUFDLElBQUMsQ0FBQSxDQUFGLEVBQUksSUFBQyxDQUFBLENBQUwsRUFBTyxJQUFDLENBQUEsQ0FBUixFQUFVLElBQUMsQ0FBQSxDQUFYLENBQUEsR0FBZ0IsSUFBQyxDQUFBLEtBQUssQ0FBQyxHQUFQLENBQUE7RUFGWDs7RUFHTixNQUFTLENBQUMsRUFBRCxDQUFBO0lBQ1IsSUFBQyxDQUFBLFFBQVEsQ0FBQyxJQUFWLENBQWUsQ0FBQSxFQUFBLENBQUEsQ0FBSyxFQUFMLENBQUEsQ0FBZjtJQUNBLE1BQUEsQ0FBTyxFQUFQO1dBQ0EsSUFBQyxDQUFBLENBQUQsSUFBTTtFQUhFOztFQUlULEtBQVEs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RUFBUyxLQUFULEVBQWUsQ0FBZjtFQURELENBQUE7O0FBSE07O0FBTVAsSUFBQSxHQUFPLFFBQUEsQ0FBQSxDQUFBO0VBQ04sRUFBQSxHQUFLLElBQUksV0FBSixDQUFBO0VBQ0wsRUFBRSxDQUFDLElBQUgsQ0FBQTtFQUNBLFVBQUEsQ0FBVyxNQUFYO0VBQ0EsSUFBQSxDQUFBO0VBRUEsRUFBRSxDQUFDLFNBQUgsQ0FBYSxHQUFiLEVBQWlCLEVBQWpCO0VBQ0EsRUFBRSxDQUFDLFNBQUgsQ0FBYSxFQUFiLEVBQWdCLEVBQWhCO0VBQ0EsRUFBRSxDQUFDLE1BQUgsQ0FBVSxFQUFWLEVBUEQ7O0VBVUMsTUFBTSxDQUFDLFFBQVAsR0FBa0IsRUFBRSxDQUFDLFdBQUgsQ0FBQTtFQUNsQixNQUFNLENBQUMsSUFBUCxDQUFBO1NBQ0EsRUFBRSxDQUFDLEdBQUgsQ0FBQTtBQWJNOztBQWVQLFVBQUEsR0FBYSxRQUFBLENBQUEsQ0FBQTtBQUNiLE1BQUEsQ0FBQSxFQUFBO0VBQUMsQ0FBQyxDQUFELEVBQUcsQ0FBSCxDQUFBLEdBQVEsRUFBRSxDQUFDLFNBQUgsQ0FBYSxNQUFiLEVBQW9CLE1BQXBCLEVBQTJCLE1BQU0sQ0FBQyxRQUFsQztTQUNSLEdBQUEsR0FBUyxNQUFNLENBQUMsTUFBUCxDQUFjLENBQWQsRUFBZ0IsQ0FBaEIsQ0FBSCxHQUEwQixLQUExQixHQUFxQztBQUYvQjs7QUFJYixZQUFBLEdBQWUsUUFBQSxDQUFBLENBQUE7U0FDZCxPQUFPLENBQUMsR0FBUixDQUFZLE1BQU0sQ0FBQyxRQUFuQixFQUE0QixFQUFFLENBQUMsU0FBSCxDQUFhLE1BQWIsRUFBb0IsTUFBcEIsRUFBMkIsTUFBTSxDQUFDLFFBQWxDLENBQTVCO0FBRGMiLCJzb3VyY2VzQ29udGVudCI6WyIjIERlbm5hIGZpbCBrYW4ga2FzdGFzXHJcbmNsYXNzIFRyYW5zZm9ybWVyXHJcblx0Y29uc3RydWN0b3I6IChAeD0wLCBAeT0wLCBAYT0wLCBAcz0xLCBAc3RhY2s9W10pIC0+XHJcblx0XHRAY29tbWFuZHMgPSBbXVxyXG5cdHB1c2ggOiAtPlxyXG5cdFx0cHVzaCgpXHJcblx0XHRAc3RhY2sucHVzaCBbQHgsQHksQGEsQHNdXHJcblx0cG9wIDogLT4gXHJcblx0XHRwb3AoKVxyXG5cdFx0W0B4LEB5LEBhLEBzXSA9IEBzdGFjay5wb3AoKVxyXG5cdHJvdGF0ZSA6IChkYSkgLT4gXHJcblx0XHRAY29tbWFuZHMucHVzaCBcInIgI3tkYX1cIlxyXG5cdFx0cm90YXRlIGRhXHJcblx0XHRAYSArPSBkYVxyXG5cdHNjYWxlIDogKGRzKSAtPiBcclxuXHRcdEBjb21tYW5kcy5wdXNoIFwicyAje2RzfVwiXHJcblx0XHRzY2FsZSBkc1xyXG5cdFx0QHMgKj0gZHNcclxuXHR0cmFuc2xhdGUgOiAoZHgsZHkpIC0+IFxyXG5cdFx0QGNvbW1hbmRzLnB1c2ggXCJ0ICN7ZHh9ICN7ZHl9XCJcclxuXHRcdHRyYW5zbGF0ZSBkeCxkeVxyXG5cdFx0QHggKz0gQHMgKiBkeCAqIGNvcyhAYSkgLSBAcyAqIGR5ICogc2luKEBhKVxyXG5cdFx0QHkgKz0gQHMgKiBkeSAqIGNvcyhAYSkgKyBAcyAqIGR4ICogc2luKEBhKVxyXG5cdGdldENvbW1hbmRzIDogLT5cclxuXHRcdF8uY2xvbmUgQGNvbW1hbmRzXHJcblx0YmFja3dhcmRzIDogKHgseSxjb21tYW5kcykgLT5cclxuXHRcdGZvciBjb21tYW5kIGluIGNvbW1hbmRzLnJldmVyc2UoKVxyXG5cdFx0XHRhcnIgPSBjb21tYW5kLnNwbGl0ICcgJ1xyXG5cdFx0XHRpZiBhcnJbMF0gPT0gJ3InXHJcblx0XHRcdFx0YSA9IC1hcnJbMV1cclxuXHRcdFx0XHR4MSA9IHggKiBjb3MoYSkgLSB5ICogc2luKGEpXHJcblx0XHRcdFx0eTEgPSB5ICogY29zKGEpICsgeCAqIHNpbihhKVxyXG5cdFx0XHRcdFt4LHldID0gW3gxLHkxXVxyXG5cdFx0XHRpZiBjb21tYW5kWzBdID09ICdzJ1xyXG5cdFx0XHRcdHggPSB4L2FyclsxXVxyXG5cdFx0XHRcdHkgPSB5L2FyclsxXVxyXG5cdFx0XHRpZiBjb21tYW5kWzBdID09ICd0J1xyXG5cdFx0XHRcdGR4ID0gYXJyWzFdXHJcblx0XHRcdFx0ZHkgPSBhcnJbMl1cclxuXHRcdFx0XHR4IC09IGR4XHJcblx0XHRcdFx0eSAtPSBkeVxyXG5cdFx0W3gseV1cclxuXHJcblx0ZHVtcCA6IC0+XHJcblx0XHRjb25zb2xlLmxvZyBAeCxAeSxAYSxAc1xyXG5cdFx0XHJcblxyXG5idXR0b24gPSBcclxudHggPSBuZXcgVHJhbnNmb3JtZXIoKVxyXG5jb2wgPSAnYmxhY2snXHJcblxyXG5jbGFzcyBCdXR0b25cclxuXHRjb25zdHJ1Y3RvciA6IChAeCxAeSxAdyxAaCkgLT5cclxuXHJcblx0ZHJhdyA6IC0+XHJcblx0XHRmaWxsIGNvbFxyXG5cdFx0cmVjdCBAeCxAeSxAdyxAaFxyXG5cclxuXHRpbnNpZGUgOiAoeCx5KSAtPlxyXG5cdFx0QHgtQHcvMiA8PSB4IDw9IEB4K0B3LzIgYW5kIEB5LUBoLzIgPD0geSA8PSBAeStAaC8yXHJcblxyXG5zZXR1cCA9IC0+XHJcblx0Y3JlYXRlQ2FudmFzIDQwMCwzMDBcclxuXHRyZWN0TW9kZSBDRU5URVJcclxuXHRhbmdsZU1vZGUgREVHUkVFU1xyXG5cdGJ1dHRvbiA9IG5ldyBCdXR0b24gMCwwLDIwLDQwXHJcblx0Y29uc29sZS5sb2cgJ29rJ1xyXG5cdHR4LmR1bXAoKVxyXG5cclxuZ3JpZCA9IC0+XHJcblx0Zm9yIGkgaW4gcmFuZ2UgMCx3aWR0aCwxMFxyXG5cdFx0bGluZSBpLDAsaSxoZWlnaHRcclxuXHRmb3IgaiBpbiByYW5nZSAwLGhlaWdodCwxMFxyXG5cdFx0bGluZSAwLGosd2lkdGgsalxyXG5cclxuZHJhdyA9IC0+XHJcblx0dHggPSBuZXcgVHJhbnNmb3JtZXJcclxuXHR0eC5wdXNoKClcclxuXHRiYWNrZ3JvdW5kICdncmF5J1xyXG5cdGdyaWQoKVxyXG5cclxuXHR0eC50cmFuc2xhdGUgMTAwLDUwXHJcblx0dHgudHJhbnNsYXRlIDIwLDIwXHJcblx0dHgucm90YXRlIDkwXHJcblx0I3R4LnNjYWxlIDJcclxuXHJcblx0YnV0dG9uLmNvbW1hbmRzID0gdHguZ2V0Q29tbWFuZHMoKVxyXG5cdGJ1dHRvbi5kcmF3KClcclxuXHR0eC5wb3AoKVxyXG5cclxubW91c2VNb3ZlZCA9IC0+XHJcblx0W3gseV0gPSB0eC5iYWNrd2FyZHMgbW91c2VYLG1vdXNlWSxidXR0b24uY29tbWFuZHNcclxuXHRjb2wgPSBpZiBidXR0b24uaW5zaWRlIHgseSB0aGVuICdyZWQnIGVsc2UgJ3doaXRlJ1xyXG5cclxubW91c2VDbGlja2VkID0gLT5cclxuXHRjb25zb2xlLmxvZyBidXR0b24uY29tbWFuZHMsdHguYmFja3dhcmRzIG1vdXNlWCxtb3VzZVksYnV0dG9uLmNvbW1hbmRzIl19
//# sourceURL=c:\github\Transformer\coffee\sketch.coffee